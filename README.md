fork from agi width some modification
